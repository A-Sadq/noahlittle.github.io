#!/usr/bin/env ruby
###########################################################################
###########################################################################
##  Copyright The Resistance (C) 1995-2011                               ##
##  Author: blass                                                        ##
##  blass[at]sdf.lonestar.org @ twitter.com/Blass_o_rama                 ##
##  Badass 1.0                                                           ##
##  This file is part of Badass.                                         ##
##  Badass is free software: you can redistribute it and/or modify       ##
##  it under the terms of the GNU General Public License as published by ##
##  the Free Software Foundation, either version 3 of the License, or    ##
##  (at your option) any later version.                                  ##
##  Badass is distributed in the hope that it will be useful,            ##
##  but WITHOUT ANY WARRANTY; without even the implied warranty of       ##
##  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the        ##
##  GNU General Public License for more details.                         ##
##  You should have received a copy of the GNU General Public License    ##
##  along with Badass. If not, see http://www.gnu.org/licenses/          ##
###########################################################################
###########################################################################
$text_color = true
dir = File.dirname(__FILE__)
require dir + "/network/lib/pb_proced_lib.rb"


system("clear")
warning " Ruby r0ck #{RUBY_VERSION} on #{RUBY_PLATFORM}"
puts ""
puts ""
title " Wapiti Ruby Interface by blass @ twitter.com/Blass_o_rama          "
title " Contact: blass[at]sdf.lonestar.org                                 "
title " IRC --> irc.cryto.net channel: #OperationBOOBS                     "
title " This script is part of Badass Toolkit                              "
title " Download Badass Toolkit latest version: http://blass.freeshell.org "      
title " You need Wapiti installed on your system to use this feature       "
title " See http://wapiti.sourceforge.net/ for download page               "
puts ""
title "     -==Wapiti Vulnerability Scanning==-   " 
title "                                           "
title "  1- Enter Wapiti Menu                     "
title "                                           "
title "  2- Enter Wapiti Menu with proxy support  "
title "                                           "
title "  3- Enter Wapiti Manual                   "
title "                                           " 
title "  4- Download and install Wapiti (apt-get) "
title "                                           "
title "  5- Exit Wapiti Menu                      "
title "                                           "
puts ""
warning "    Your choice: "
option1 = gets.chomp
system("clear")


case option1
when "1"
  warning " Ruby r0ck #{RUBY_VERSION} on #{RUBY_PLATFORM}"
  puts ""
  puts ""
  title " Wapiti Ruby Interface by blass @ twitter.com/Blass_o_rama          "
  title " Contact: blass[at]sdf.lonestar.org                                 "
  title " IRC --> irc.cryto.net channel: #OperationBOOBS                     "
  title " This script is part of Badass Toolkit                              "
  title " Download Badass Toolkit latest version: http://blass.freeshell.org "
  title " You need Wapiti installed on your system to use this feature       "
  title " See http://wapiti.sourceforge.net/ for download page               "
  puts ""
  title "    -==Wapiti==-                                                       "
  title "                                                                       "
  title " 1- Wapiti GET_ALL: only use GET request                               "
  title "                                                                       "
  title " 2- Wapiti GET_XSS: only XSS attacks with HTTP GET method              "
  title "                                                                       "
  title " 3- Wapiti POST_XSS: only XSS attacks with HTTP POST method            "
  title "                                                                       "
  title " 4- Wapiti YOUR custom setting (ex: wapiti http://site.com/ your rule) "
  title "                                                                       "
  puts ""
  warning "   Your Choice: "
  option2 = gets.chomp
  puts ""
  warning "   Host: "  
  case option2
    
  when "1"
    while (ip = gets.chomp)
      system("clear && date && echo Wapiti")
      begin
        system("wapiti  #{ip} -u -v 2 -m GET_ALL")
      end
    end 
    
  when "2"
    while (ip = gets.chomp)
      system("clear && date && echo Wapiti")
      begin
        system("wapiti #{ip} -u -v 2 -m GET_XSS")
      end   
    end
    
  when "3"
    while (ip = gets.chomp)
      system("clear && date && echo Wapiti")
      begin
        system("wapiti #{ip} -u -v 2 -m POST_XSS")
      end   
    end
    
  when "4"
    while (ip = gets.chomp)
      system("clear && date && echo Wapiti Input YOUR custom wapiti setting: ")
      begin
        system("#{ip}")
      end   
    end




#this is the end, my only friend...
  

else system("clear")
end


when "2"
  warning " Wapiti with proxy support\n\n"
  puts ""
  system("perl #{dir}/Wapiti.pl")
  puts ""
  
when "3"
  
  warning " Will now trigger Wapiti Manual...\n\n"
  puts ""
  system("man wapiti")
  puts ""
  warning " You may also choose to visit http://wapiti.sourceforge.net/ for more information\n\n"


when "4"
  warning " Will now try to install Wapiti...\n\n"
  puts ""
  system("sudo apt-get install wapiti")
  puts ""

  
  
when "5"
  system("clear")

else
  system("clear")  
end



