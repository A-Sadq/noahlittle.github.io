#!/usr/bin/env ruby
###########################################################################
###########################################################################
##  Copyright The Resistance (C) 1995-2011                               ##
##  Author: blass                                                        ##
##  blass[at]sdf.lonestar.org @ twitter.com/Blass_o_rama                 ##
##  Badass 1.0                                                           ##
##  This file is part of Badass.                                         ##
##  Badass is free software: you can redistribute it and/or modify       ##
##  it under the terms of the GNU General Public License as published by ##
##  the Free Software Foundation, either version 3 of the License, or    ##
##  (at your option) any later version.                                  ##
##  Badass is distributed in the hope that it will be useful,            ##
##  but WITHOUT ANY WARRANTY; without even the implied warranty of       ##
##  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the        ##
##  GNU General Public License for more details.                         ##
##  You should have received a copy of the GNU General Public License    ##
##  along with Badass. If not, see http://www.gnu.org/licenses/          ##
###########################################################################
###########################################################################
## This script was based on pentbox 1.4 and re-written by blass          ##
###########################################################################
###########################################################################
$text_color = true
dir = File.dirname(__FILE__)
require dir + "/lib/pb_proced_lib.rb"

module Network_pb
class Samy_mac_loc_pb
def initialize()


require "net/http"
require "uri"

url_sam1 = "http://samy.pl/mapxss/?mac="
# url_sam2 = "http://samy.pl/androidmap/index.php?mac=MAC_ADDR&commit=Probe"

puts ""
title " MAC Address Geolocation "
puts ""
warning " Insert MAC address\n"
puts ""
warning " Example: 0a:0a:0a:0a:0a:0a\n\n"
puts ""
warning "   Mac: "
mac = gets_pb.chomp.gsub(":", "-")

begin
	url = URI.parse(url_sam1 + mac)
	http = Net::HTTP.new(url.host, url.port)
	resp = http.get(url.to_s)
	if resp.code == "200"
		data = resp.body.split("<div id=addy>")[1].split("</div>")[0].gsub("<br>", "\n") 
		puts data
	else
		puts ""
		warning " Error connecting to Samy's host..."
		puts ""
	end
rescue
	puts ""
	warning " Error connecting to Samy's host..."
	puts ""
end

end
end
end

