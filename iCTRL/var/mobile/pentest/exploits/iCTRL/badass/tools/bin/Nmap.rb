#!/usr/bin/env ruby
###########################################################################
###########################################################################
##  Copyright The Resistance (C) 1995-2011                               ##
##  Author: blass                                                        ##
##  blass[at]sdf.lonestar.org @ twitter.com/Blass_o_rama                 ##
##  Badass 1.0                                                           ##
##  This file is part of Badass.                                         ##
##  Badass is free software: you can redistribute it and/or modify       ##
##  it under the terms of the GNU General Public License as published by ##
##  the Free Software Foundation, either version 3 of the License, or    ##
##  (at your option) any later version.                                  ##
##  Badass is distributed in the hope that it will be useful,            ##
##  but WITHOUT ANY WARRANTY; without even the implied warranty of       ##
##  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the        ##
##  GNU General Public License for more details.                         ##
##  You should have received a copy of the GNU General Public License    ##
##  along with Badass. If not, see http://www.gnu.org/licenses/          ##
###########################################################################
###########################################################################
$text_color = true
dir = File.dirname(__FILE__)
require dir + "/network/lib/pb_proced_lib.rb"


system("clear")
warning " Ruby r0ck #{RUBY_VERSION} on #{RUBY_PLATFORM}"
puts ""
puts ""
title " Nmap Ruby Interface by blass @ twitter.com/Blass_o_rama            "
title " Contact: blass[at]sdf.lonestar.org                                 "
title " IRC --> irc.cryto.net channel: #OperationBOOBS                     "
title " This script is part of Badass Toolkit                              "
title " Download Badass Toolkit latest version: http://blass.freeshell.org "
title " You need Nmap installed on your system to use this feature         "
title " See http://insecure.org for download page                          "
puts ""
warning " Your scan result will be saved in /badass folder\n"
puts ""
title "     -==Nmap==-                          " 
title "                                         "
title "  1- Enter Nmap Menu                     "
title "                                         "
title "  2- Download and install Nmap (apt-get) "
title "                                         "
title "  3- Enter Nmap Manual                   "
title "                                         "
title "  4- Exit Nmap Menu                      "
title "                                         "
puts ""
warning "    Your choice: "
option1 = gets.chomp
system("clear") 
puts ""


case option1
when "1"
  puts ""
  warning " Your scan will be saved as Nmap-ip/host.txt in /badass folder\n"
  puts "" 
  title "     -==Nmap==-                   "
  title "                                  "
  title " 1-  Nmap Full Scan all scripts   "
  title " 2-  Nmap Intrusive Scan          "
  title " 3-  Nmap Service/OS Version Scan "
  title " 4-  Nmap Stealth Scan -sS        "
  title " 5-  Nmap UDP Scan -sU            "
  title " 6-  Nmap Tcp NULL Scan -sN       "
  title " 7-  Nmap FIN Scan -sF            "
  title " 8-  Nmap Xmas Scan -sX           "
  title " 9-  Nmap IPv6 Scan -6            "
  title " 10- Nmap No Ping scan -Pn        "
  title " 11- Nmap TCP connect scan -sT    "
  title " 12- Nmap TCP ACK scan -sA        "
  title " 13- Nmap TCP Window scan -sW     "
  title " 14- Nmap TCP Maimon scan -sM     "
  title " 15- Nmap YOUR custom nmap scan   "
  title "                                  "
  puts ""
  warning "    Your Choice: "
  option2 = gets.chomp
  puts ""
  warning "    Target: "

  
  case option2
    
  when "1"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("nmap -d1 -O -A -p 0-65535 #{ip} --script=ALL -oN=Nmap-#{ip}.txt")
      end
    end 
    
    
  when "2"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("nmap -d1 -O -A -p 0-65535 #{ip} --script intrusive -oN=Nmap-#{ip}.txt")
      end   
    end
    
  when "3"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("nmap -d1 -A -O -sV -p 0-65535 #{ip} --fuzzy --version-all -oN=Nmap-#{ip}.txt")
      end   
    end
    
  when "4"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("nmap -d1 -sS -p 0-65535 #{ip} -oN=Nmap-#{ip}.txt")
      end   
    end
    
  when "5"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("nmap -d1 -sU -p 0-65535 #{ip} -oN=Nmap-#{ip}.txt")
      end   
    end
    
  when "6"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("nmap -d1 -sN -p 0-65535 #{ip} -oN=Nmap-#{ip}.txt")
      end   
    end
    
  when "7"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("nmap -d1 -sF -p 0-65535 #{ip} -oN=Nmap-#{ip}.txt")
      end   
    end
    
  when "8"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("nmap -d1 -sX -p 0-65535 #{ip} -oN=Nmap-#{ip}.txt")
      end   
    end
    
  when "9"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("nmap -d1 -6 -p 0-65535 #{ip} -oN=Nmap-#{ip}.txt")
      end   
    end
    
  when "10"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("nmap -d1 -Pn -p 0-65535 #{ip} -oN=Nmap-#{ip}.txt")
      end   
    end
    
  when "11"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("nmap -d1 -sT -p 0-65535 #{ip} -oN=Nmap-#{ip}.txt")
      end   
    end
    
  when "12"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("nmap -d1 -sA -p 0-65535 #{ip} -oN=Nmap-#{ip}.txt")
      end   
    end
    
  when "13"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("nmap -d1 -sW -p 0-65535 #{ip} -oN=Nmap-#{ip}.txt")
      end   
    end
    
  when "14"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("nmap -d1 -sM -p 0-65535 #{ip} -oN=Nmap-#{ip}.txt")
      end   
    end
    
  when "15"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("#{ip}")
      end   
    end


  else
    system("clear")

#this is the end, my only friend...
  end



when "2"
  warning " Will attemp to download Nmap from your repository...\n\n"
  puts ""
  system("date && sudo apt-get install nmap")
  puts ""
  warning "You may also choose to visit http://insecure.org for download page\n\n"
  system("clear")

when "3"
  warning "Will now trigger Nmap Manual\n\n"
  system("man nmap")
  
when "4"
  system("clear")
  
  
  
else
  system("clear")
end
