#!/usr/bin/env ruby
###########################################################################
###########################################################################
##  Copyright The Resistance (C) 1995-2011                               ##
##  Author: blass                                                        ##
##  blass[at]sdf.lonestar.org @ twitter.com/Blass_o_rama                 ##
##  Badass 1.0                                                           ##
##  This file is part of Badass.                                         ##
##  Badass is free software: you can redistribute it and/or modify       ##
##  it under the terms of the GNU General Public License as published by ##
##  the Free Software Foundation, either version 3 of the License, or    ##
##  (at your option) any later version.                                  ##
##  Badass is distributed in the hope that it will be useful,            ##
##  but WITHOUT ANY WARRANTY; without even the implied warranty of       ##
##  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the        ##
##  GNU General Public License for more details.                         ##
##  You should have received a copy of the GNU General Public License    ##
##  along with Badass. If not, see http://www.gnu.org/licenses/          ##
###########################################################################
###########################################################################
$text_color = true
dir = File.dirname(__FILE__)
require dir + "/network/lib/pb_proced_lib.rb"


system("clear")
warning " Ruby r0ck #{RUBY_VERSION} on #{RUBY_PLATFORM}"
puts ""
puts ""
title " Nikto Ruby Interface by blass @ twitter.com/Blass_o_rama           "
title " Contact: blass[at]sdf.lonestar.org                                 "
title " IRC --> irc.cryto.net channel: #OperationBOOBS                     "
title " This script is part of Badass Toolkit                              "
title " Download Badass Toolkit latest version: http://blass.freeshell.org "
puts ""
warning " For Proxy Support see nikto.conf in /badass/tools/bin/nikto/\n"
puts ""
title "    -==Nikto==-                           " 
title "                                          "
title " 1- Enter Nikto Menu                      "
title "                                          "
title " 2- Enter Nikto Menu with proxy support   "
title "                                          "
title " 3- Enter Nikto Menu with output.txt file "
title "                                          "
title " 4- Update Nikto                          "
title "                                          "
title " 5- Exit Nikto Menu                       "
title "                                          "
puts ""
warning "   Your choice: "
option1 = gets.chomp
system("clear") 



case option1
when "1"
  system("clear")
  warning " Ruby r0ck #{RUBY_VERSION} on #{RUBY_PLATFORM}"
  puts ""
  puts ""
  title " Nikto Ruby Interface by blass @ twitter.com/Blass_o_rama           "
  title " Contact: blass[at]sdf.lonestar.org                                 "
  title " IRC --> irc.cryto.net channel: #OperationBOOBS                     "
  title " This script is part of Badass Toolkit                              "
  title " Download Badass Toolkit latest version: http://blass.freeshell.org "
  puts ""
  puts ""
  title "     -==Nikto==-                            "
  title "                                            "
  title " 1-  Nikto Full Scan                        "
  title " 2-  Nikto Dos Testing                      "
  title " 3-  Nikto XSS Testing                      "
  title " 4-  Nikto Sql Injection Testing            "
  title " 5-  Nikto Remote File Retrieval - WebRoot  "
  title " 6-  Nikto Remote File Retrieval - Server   "
  title " 7-  Nikto Command Execution / Remote Shell "
  title " 8-  Nikto Remote Source Inclusion          "
  title " 9-  Nikto Information Disclosure           "
  title " 10- Nikto Misconfiguration / Default File  "
  title " 11- Nikto Interesting File / Seen in logs  "
  title " 12- Nikto File Upload                      "
  title " 13- Nikto Authentication Bypass            "
  title " 14- Nikto Software Identification          "
  title "                                            "
  puts ""
  warning "    Your Choice: "
  option2 = gets.chomp
  puts ""
  warning "    Host: "

  
  case option2
    
  when "1"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("ruby #{dir}/nikto/nikto.pl -host #{ip} -mutate 1 2 3 4 -evasion 1 2 3 4 5 6 7 8 -Display V 1 3 4 -Cgidirs ALL -Plugins ALL -Tuning 1 2 3 4 5 7 8 9 a b c")
      end
    end 
    
    
  when "2"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("ruby #{dir}/nikto/nikto.pl -host #{ip} -evasion 1 2 3 4 5 6 7 8 -Display V 1 3 4 -Tuning 6")
      end   
    end
    
  when "3"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("ruby #{dir}/nikto/nikto.pl -host #{ip} -mutate 1 2 3 4 -evasion 1 2 3 4 5 6 7 8 -Display V 1 3 4 -Tuning 4")
      end   
    end
    
  when "4"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("ruby #{dir}/nikto/nikto.pl -host #{ip} -mutate 1 2 3 4 -evasion 1 2 3 4 5 6 7 8 -Display V 1 3 4 -Tuning 9")
      end   
    end
    
  when "5"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("ruby #{dir}/nikto/nikto.pl -host #{ip} -mutate 1 2 3 4 -evasion 1 2 3 4 5 6 7 8 -Display V 1 3 4 -Tuning 5")
      end   
    end
    
  when "6"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("ruby #{dir}/nikto/nikto.pl -host #{ip} -mutate 1 2 3 4 -evasion 1 2 3 4 5 6 7 8 -Display V 1 3 4 -Tuning 7")
      end   
    end
    
  when "7"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("ruby #{dir}/nikto/nikto.pl -host #{ip} -mutate 1 2 3 4 -evasion 1 2 3 4 5 6 7 8 -Display V 1 3 4 -Tuning 8")
      end   
    end
    
  when "8"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("ruby #{dir}/nikto/nikto.pl -host #{ip} -mutate 1 2 3 4 -evasion 1 2 3 4 5 6 7 8 -Display V 1 3 4 -Tuning c")
      end   
    end
    
  when "9"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("ruby #{dir}/nikto/nikto.pl -host #{ip} -mutate 1 2 3 4 -evasion 1 2 3 4 5 6 7 8 -Display V 1 3 4 -Tuning 3")
      end   
    end
    
  when "10"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("ruby #{dir}/nikto/nikto.pl -host #{ip} -mutate 1 2 3 4 -evasion 1 2 3 4 5 6 7 8 -Display V 1 3 4 -Tuning 2")
      end   
    end
    
  when "11"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("ruby #{dir}/nikto/nikto.pl -host #{ip} -mutate 1 2 3 4 -evasion 1 2 3 4 5 6 7 8 -Display V 1 3 4 -Tuning 1")
      end   
    end
    
  when "12"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("ruby #{dir}/nikto/nikto.pl -host #{ip} -mutate 1 2 3 4 -evasion 1 2 3 4 5 6 7 8 -Display V 1 3 4 -Tuning 0")
      end   
    end
    
  when "13"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("ruby #{dir}/nikto/nikto.pl -host #{ip} -mutate 1 2 3 4 -evasion 1 2 3 4 5 6 7 8 -Display V 1 3 4 -Tuning a")
      end   
    end
    
  when "14"
    while (ip = gets.chomp)
      system("clear && date && echo Scanning...")
      begin
        system("ruby #{dir}/nikto/nikto.pl -host #{ip} -mutate 1 2 3 4 -evasion 1 2 3 4 5 6 7 8 -Display V 1 3 4 -Tuning b")
      end   
    end
else
  system("clear")  


#this is the end, my only friend...
  end





  
when "2"
  warning " Configure your proxy in/badass/tools/bin/nikto/nikto.conf\n\n"
  puts ""
  system("ruby #{dir}/Nikto2.rb")
  puts ""


when "3"
  warning " Nikto will output the scan in /badass folder\n\n"
  puts ""
  system("perl #{dir}/Nikto.pl")
  puts ""
  
when "4"
  
  warning " Will attemp to update nikto...\n\n"
  puts ""
  system("ruby #{dir}/nikto/nikto.pl -update")
  puts ""
  warning " You may also choose to visit http://cirt.net/ for download page\n\n"

when "5"
  system("clear")


else
  system("clear")
end

